DROP TABLE IF EXISTS game_platforms;
DROP TABLE IF EXISTS game_genres;
DROP TABLE IF EXISTS order_games;
DROP TABLE IF EXISTS games;
DROP TABLE IF EXISTS platforms;
DROP TABLE IF EXISTS genres;
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS accounts;

CREATE TABLE games(id BIGINT GENERATED BY DEFAULT AS IDENTITY, name VARCHAR(255) NOT NULL, description VARCHAR(255), age_rating INT NOT NULL, cost DOUBLE NOT NULL, online_game BIT(1));
CREATE TABLE platforms(id BIGINT GENERATED BY DEFAULT AS IDENTITY, name VARCHAR(255) NOT NULL, company VARCHAR(255));
CREATE TABLE genres(id BIGINT GENERATED BY DEFAULT AS IDENTITY, genre VARCHAR(255) NOT NULL);
CREATE TABLE game_platforms(id BIGINT GENERATED BY DEFAULT AS IDENTITY, fk_games_id VARCHAR(255) NOT NULL, fk_platforms_id VARCHAR(255) NOT NULL, FOREIGN KEY (fk_games_id) REFERENCES games (id) ON DELETE CASCADE, FOREIGN KEY (fk_platforms_id) REFERENCES platforms (id) ON DELETE CASCADE);
CREATE TABLE game_genres(id BIGINT GENERATED BY DEFAULT AS IDENTITY, fk_games_id VARCHAR(255) NOT NULL, fk_genres_id VARCHAR(255) NOT NULL, FOREIGN KEY (fk_games_id) REFERENCES games (id) ON DELETE CASCADE, FOREIGN KEY (fk_genres_id) REFERENCES genres (id) ON DELETE CASCADE);

CREATE TABLE accounts(id BIGINT GENERATED BY DEFAULT AS IDENTITY, username VARCHAR(255) NOT NULL UNIQUE, password VARCHAR(255) NOT NULL, firstname VARCHAR(255), surname VARCHAR(255), age INT NOT NULL, email VARCHAR(255) NOT NULL, phone_number VARCHAR(255), admin BIT(1) NOT NULL);

CREATE TABLE orders(id BIGINT GENERATED BY DEFAULT AS IDENTITY, fk_accounts_id BIGINT NOT NULL, order_date DATETIME(6), FOREIGN KEY (fk_accounts_id) REFERENCES accounts (id) ON DELETE CASCADE);
CREATE TABLE order_games(id BIGINT GENERATED BY DEFAULT AS IDENTITY, fk_orders_id BIGINT NOT NULL, fk_games_id BIGINT NOT NULL, FOREIGN KEY (fk_orders_id) REFERENCES orders (id) ON DELETE CASCADE, FOREIGN KEY (fk_games_id) REFERENCES games (id) ON DELETE CASCADE);